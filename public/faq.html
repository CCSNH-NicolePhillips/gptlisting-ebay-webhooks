<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FAQ – DraftPilot</title>
    <link rel="stylesheet" href="/draftpilot.css">
    <style>
      /* FAQ specific styles */
      .faq-accordion {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      
      .faq-item {
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        overflow: hidden;
        background: var(--bg-card);
        transition: all 0.2s ease;
      }
      
      .faq-item:hover {
        border-color: var(--accent);
      }
      
      .faq-question {
        width: 100%;
        padding: 16px 20px;
        background: none;
        border: none;
        color: var(--text-primary);
        font-size: 1rem;
        font-weight: 600;
        text-align: left;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
      }
      
      .faq-question:hover {
        color: var(--accent);
      }
      
      .faq-icon {
        width: 20px;
        height: 20px;
        min-width: 20px;
        transition: transform 0.2s ease;
        color: var(--text-muted);
      }
      
      .faq-item.active .faq-icon {
        transform: rotate(180deg);
        color: var(--accent);
      }
      
      .faq-answer {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }
      
      .faq-item.active .faq-answer {
        max-height: 500px;
      }
      
      .faq-answer-content {
        padding: 0 20px 20px 20px;
        color: var(--text-muted);
        line-height: 1.6;
      }
      
      .faq-answer-content a {
        color: var(--accent);
        text-decoration: underline;
      }
      
      /* Reduce excessive white space */
      .dp-main {
        max-width: 900px;
        margin: 0 auto;
      }
      
      .dp-card {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <script src="/auth-client.js"></script>
    <script>
      // If we're returning from a provider logout that could only come back to origin,
      // immediately forward to the intended page to avoid flashing the dashboard.
      (function(){
        try {
          var next = sessionStorage.getItem('postLogoutRedirect');
          if (next) { sessionStorage.removeItem('postLogoutRedirect'); location.replace(next); return; }
        } catch {}
      })();
    </script>
    <script>
      // Do not force redirect immediately; show a friendly banner if not signed in
      // We'll still require auth before sensitive actions.
      (async () => {
        try {
          const ok = await authClient.ensureAuth();
          if (!ok) {
            try {
              const mode = await authClient.getMode?.();
              if (mode && mode !== 'none') {
                await authClient.requireAuth?.();
                return;
              }
            } catch {}
            const b = document.getElementById('authBanner');
            if (b) b.style.display = 'block';
          } else {
            // If already authenticated (SSO, returning from login, etc.), ensure banner is hidden
            const b = document.getElementById('authBanner');
            if (b) b.style.display = 'none';
            // Verify the backend also sees our session; hide banner on success
            try {
              const r = await authClient.authFetch('/.netlify/functions/me');
              if (r.ok) { const b2 = document.getElementById('authBanner'); if (b2) b2.style.display = 'none'; }
            } catch {}
          }
        } catch {}
      })();
    </script>
    
    <!-- Main FAQ Shell -->
    <div class="dp-shell" id="mainCard">
      <!-- Sidebar -->
      <aside class="dp-sidebar">
        <!-- Brand Area -->
        <div class="dp-sidebar__brand">
          <img src="logo/LogoWhiteText_NoBg.png" alt="DraftPilot - AI Listing Studio" class="dp-brand-logo" />
        </div>
        
        <!-- Navigation -->
        <nav class="dp-sidebar__nav">
          <!-- Primary Navigation Group -->
          <div class="dp-nav-group">
            <div class="dp-nav-group__label">APP</div>
            <div class="dp-nav-group__items">
              <a href="/index.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                  <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span class="dp-nav-item__label">Overview</span>
              </a>
              <a href="/quick-list.html" class="dp-nav-item" id="navQuickList">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="dp-nav-item__label">Create Listings</span>
              </a>
              <a href="/drafts.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                <span class="dp-nav-item__label">Drafts</span>
              </a>
            </div>
          </div>
          
          <!-- Account Navigation Group -->
          <div class="dp-nav-group">
            <div class="dp-nav-group__label">ACCOUNT</div>
            <div class="dp-nav-group__items">
              <a href="/policies-manage.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                <span class="dp-nav-item__label">eBay Policies</span>
              </a>
              <a href="/location.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <span class="dp-nav-item__label">Inventory Locations</span>
              </a>
              <a href="/settings.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M12 1v6m0 6v6m5.196-15.196l-4.243 4.243m0 5.656l-4.242 4.243m15.195-5.196l-4.242-4.243m-5.657 0l-4.243-4.243"></path>
                </svg>
                <span class="dp-nav-item__label">Settings</span>
              </a>
              <a href="/faq.html" class="dp-nav-item dp-nav-item--active">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span class="dp-nav-item__label">FAQ</span>
              </a>
              <a href="/support.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span class="dp-nav-item__label">Support</span>
              </a>
            </div>
          </div>
        </nav>
        
        <!-- Spacer -->
        <div class="dp-sidebar__spacer"></div>
        
        <!-- User Footer -->
        <div class="dp-sidebar__footer">
          <div class="dp-user-card" id="userCard">
            <div class="dp-user-card__avatar" id="userAvatar">U</div>
            <div class="dp-user-card__info">
              <div class="dp-user-card__name" id="userName">Loading...</div>
              <div class="dp-user-card__status" id="userEmail">Signed in</div>
            </div>
          </div>
          <div class="dp-user-menu" id="userMenu" style="display: none;">
            <a href="/logout.html" class="dp-user-menu__item">
              <svg class="dp-user-menu__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
              <span>Sign out</span>
            </a>
          </div>
        </div>
      </aside>
      
      <!-- Mobile Backdrop -->
      <div class="dp-mobile-backdrop"></div>
      
      <!-- Main Content Wrapper -->
      <div class="dp-main-wrapper">
        <!-- Top Bar -->
        <header class="dp-topbar">
          <!-- Left: Mobile Menu + Page Title -->
          <div class="dp-topbar-left">
            <button
              class="dp-topbar-icon dp-topbar-icon--menu"
              id="mobileMenuButton"
              aria-label="Open navigation"
              aria-expanded="false"
              type="button"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="6" x2="20" y2="6"></line>
                <line x1="4" y1="12" x2="20" y2="12"></line>
                <line x1="4" y1="18" x2="20" y2="18"></line>
              </svg>
            </button>
            <h1 class="dp-topbar__title">FAQ</h1>
            <p class="dp-topbar__subtitle">Answers to common questions about DraftPilot</p>
          </div>
          
          <!-- Right: Back Button -->
          <div class="dp-topbar-right">
            <a href="/index.html" class="dp-btn dp-btn-secondary">← Back to Dashboard</a>
          </div>
        </header>
        
        <!-- Main Content Area -->
        <main class="dp-main">
          <!-- Auth Banner -->
          <div id="authBanner" class="dp-card" style="display:none;">
            <div class="dp-card__content">
              <p style="margin-bottom: 16px;">You need to sign in to access DraftPilot.</p>
              <button id="bannerLogin" class="dp-btn dp-btn-primary">Sign in</button>
            </div>
          </div>
          
          <!-- FAQ Content -->
          <div class="dp-grid">
            <section class="dp-card">
              <div class="dp-card__header">
                <h2 class="dp-card__title">Frequently Asked Questions</h2>
                <p class="dp-card__subtitle">Click any question to see the answer</p>
              </div>
              
              <div class="dp-card__content">
                <div class="faq-accordion">
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>How many photos can I process at once?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        DraftPilot can process up to 100 photos in a single batch. SmartDrafts will automatically group related images together (front, back, side views of the same product) and create separate draft listings for each distinct product it identifies. For optimal performance and accuracy, we recommend uploading photos in batches of 20-50 at a time.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>Do I have to use Dropbox?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        No, Dropbox is completely optional. While connecting Dropbox enables automatic import of new product photos from a chosen folder, you can also upload photos manually from your computer using the "Upload from device" option on the Create Listings page.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>What does SmartDrafts actually do?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        SmartDrafts uses Vision AI and GPT-4 to analyze your product photos and automatically generate complete eBay listing drafts. It groups related images together, identifies the product, generates a compelling title and description, suggests pricing based on market research, and assigns the appropriate eBay category. You get ready-to-publish drafts in minutes instead of hours.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>Will anything be published automatically?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        No, DraftPilot never publishes listings automatically. It only creates drafts that you can review, edit, and publish manually when you're ready. You have complete control over what goes live on eBay. Every draft stays in "UNPUBLISHED" status until you explicitly choose to publish it.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>Can I change how titles or descriptions are written?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        Yes! You can edit any draft before publishing it to customize the title, description, pricing, and other details. For system-wide preferences on how DraftPilot generates content, check the Settings page where you can configure default behaviors and customize the AI's output style (additional configuration options coming soon).
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>How accurate is the AI pricing?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        DraftPilot uses multiple pricing sources including Amazon marketplace data, brand websites, and product databases to suggest competitive prices. The AI applies smart logic to detect bundle pricing and adjust accordingly. However, all pricing suggestions should be reviewed and can be edited before publishing to ensure they match your margin requirements and market strategy.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>What eBay account settings do I need?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        You need to connect your eBay account, opt into eBay Business Policies, and set up at least one payment policy, shipping policy, return policy, and inventory location. The setup wizard will guide you through each step when you first connect your account.
                      </div>
                    </div>
                  </div>
                  
                  <div class="faq-item">
                    <button class="faq-question">
                      <span>Is my data secure?</span>
                      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <div class="faq-answer">
                      <div class="faq-answer-content">
                        Yes. DraftPilot uses industry-standard security practices. Your eBay and Dropbox credentials are stored using OAuth tokens (never passwords), and all API communications are encrypted. User data is scoped per account, and you can disconnect services at any time from the dashboard. See our <a href="/privacy.html">Privacy Policy</a> for full details.
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>
    
    <script>
      async function refreshStatus() {
        let s = null;
        try {
          let headers = { };
          try {
            const t = await authClient.getToken?.();
            if (t) headers = Object.assign(headers, { Authorization: `Bearer ${t}` });
          } catch {}
          const res = await authClient.authFetch('/.netlify/functions/status', { headers });
          s = await res.json().catch(() => null);
        } catch (e) {
          console.error('[FAQ] Failed to load status:', e);
        }
        
        if (!s) return;
        
        // Update sidebar user card
        try {
          const user = s.user || {};
          const userName = document.getElementById('userName');
          const userEmail = document.getElementById('userEmail');
          const userAvatar = document.getElementById('userAvatar');
          const topbarAvatar = document.getElementById('topbarAvatar');
          
          const name = user.name || user.given_name || '';
          const email = user.email || '';
          const displayName = name || email || 'User';
          const initial = displayName.charAt(0).toUpperCase();
          
          if (userName) userName.textContent = displayName;
          if (userEmail) userEmail.textContent = email || 'Signed in';
          if (userAvatar) userAvatar.textContent = initial;
          if (topbarAvatar) topbarAvatar.textContent = initial;
        } catch {}
      }
      
      const bannerLoginBtn = document.getElementById('bannerLogin');
      if (bannerLoginBtn) bannerLoginBtn.onclick = () => {
        try { sessionStorage.setItem('returnTo', '/faq.html'); } catch {}
        location.href = '/login.html';
      };
      
      function initUserMenu() {
        const userCard = document.getElementById('userCard');
        const userMenu = document.getElementById('userMenu');
        
        if (!userCard || !userMenu) return;
        
        userCard.addEventListener('click', (e) => {
          e.stopPropagation();
          const isVisible = userMenu.style.display !== 'none';
          userMenu.style.display = isVisible ? 'none' : 'block';
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
          if (!userCard.contains(e.target) && !userMenu.contains(e.target)) {
            userMenu.style.display = 'none';
          }
        });
      }

      // Load user status on page load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          refreshStatus();
          initUserMenu();
        });
      } else {
        refreshStatus();
        initUserMenu();
      }
      
      // FAQ Accordion functionality
      document.querySelectorAll('.faq-question').forEach(button => {
        button.addEventListener('click', function() {
          const faqItem = this.parentElement;
          const isActive = faqItem.classList.contains('active');
          
          // Close all other items
          document.querySelectorAll('.faq-item').forEach(item => {
            item.classList.remove('active');
          });
          
          // Toggle current item
          if (!isActive) {
            faqItem.classList.add('active');
          }
        });
      });
      
      // Mobile menu toggle
      const hamburger = document.getElementById('mobileMenuButton');
      const shell = document.querySelector('.dp-shell');
      const backdrop = document.querySelector('.dp-mobile-backdrop');

      if (hamburger && shell && backdrop) {
        hamburger.addEventListener('click', () => {
          shell.classList.toggle('dp-shell--nav-open');
          const isOpen = shell.classList.contains('dp-shell--nav-open');
          hamburger.setAttribute('aria-expanded', isOpen);
        });

        backdrop.addEventListener('click', () => {
          shell.classList.remove('dp-shell--nav-open');
          hamburger.setAttribute('aria-expanded', 'false');
        });
      }
    </script>
  </body>
</html>
