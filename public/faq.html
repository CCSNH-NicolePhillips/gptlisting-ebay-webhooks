<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DraftPilot – FAQ</title>
    <link rel="stylesheet" href="/draftpilot.css">
    <style>
      body {
        font-family:
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Arial,
          sans-serif;
        margin: 0;
        padding: 2rem;
        background: #0b1020;
        color: #f4f6fb;
      }
      .card {
        max-width: 760px;
        margin: 0 auto;
        background: #141a33;
        border: 1px solid #2a335c;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      }
      h1 {
        margin-top: 0;
        font-weight: 700;
        letter-spacing: 0.2px;
      }
      a {
        color: #a8c1ff;
      }
      .small {
        font-size: 0.85rem;
        opacity: 0.8;
      }
      .muted {
        color: #a2a9c8;
      }
      .dp-faq-list {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      .dp-faq-item {
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #26305a;
      }
      .dp-faq-item:last-child {
        border-bottom: none;
        padding-bottom: 0;
      }
      .dp-faq-question {
        margin: 0 0 0.75rem 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: #cbd5ff;
      }
      .dp-faq-answer {
        margin: 0;
        line-height: 1.6;
        color: #a2a9c8;
      }
    </style>
  </head>
  <body>
    <script src="/auth-client.js"></script>
    <script>
      // If we're returning from a provider logout that could only come back to origin,
      // immediately forward to the intended page to avoid flashing the dashboard.
      (function(){
        try {
          var next = sessionStorage.getItem('postLogoutRedirect');
          if (next) { sessionStorage.removeItem('postLogoutRedirect'); location.replace(next); return; }
        } catch {}
      })();
    </script>
    <script>
      // Do not force redirect immediately; show a friendly banner if not signed in
      // We'll still require auth before sensitive actions.
      (async () => {
        try {
          const ok = await authClient.ensureAuth();
          if (!ok) {
            try {
              const mode = await authClient.getMode?.();
              if (mode && mode !== 'none') {
                await authClient.requireAuth?.();
                return;
              }
            } catch {}
            const b = document.getElementById('authBanner');
            if (b) b.style.display = 'block';
          } else {
            // If already authenticated (SSO, returning from login, etc.), ensure banner is hidden
            const b = document.getElementById('authBanner');
            if (b) b.style.display = 'none';
            // Verify the backend also sees our session; hide banner on success
            try {
              const r = await authClient.authFetch('/.netlify/functions/me');
              if (r.ok) { const b2 = document.getElementById('authBanner'); if (b2) b2.style.display = 'none'; }
            } catch {}
          }
        } catch {}
      })();
    </script>
    <!-- Lightweight loading state to avoid flashes while auth/status loads -->
    <div class="card" id="loadingCard" style="display:block; text-align:center;">
      <h1>Loading…</h1>
      <p class="muted">Preparing your workspace</p>
    </div>
    
    <!-- Main FAQ Shell -->
    <div class="dp-shell" id="mainCard" style="display:none;">
      <!-- Sidebar -->
      <aside class="dp-sidebar">
        <!-- Brand Area -->
        <div class="dp-sidebar__brand">
          <img src="logo/LogoWhiteText_NoBg.png" alt="DraftPilot - AI Listing Studio" class="dp-brand-logo" />
        </div>
        
        <!-- Navigation -->
        <nav class="dp-sidebar__nav">
          <!-- Primary Navigation Group -->
          <div class="dp-nav-group">
            <div class="dp-nav-group__label">APP</div>
            <div class="dp-nav-group__items">
              <a href="/index.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                  <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span class="dp-nav-item__label">Overview</span>
              </a>
              <a href="/quick-list.html" class="dp-nav-item" id="navQuickList">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="dp-nav-item__label">Create Listings</span>
              </a>
              <a href="/drafts.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                <span class="dp-nav-item__label">Drafts</span>
              </a>
            </div>
          </div>
          
          <!-- Account Navigation Group -->
          <div class="dp-nav-group">
            <div class="dp-nav-group__label">ACCOUNT</div>
            <div class="dp-nav-group__items">
              <a href="/policies-manage.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                <span class="dp-nav-item__label">eBay Policies</span>
              </a>
              <a href="/location.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <span class="dp-nav-item__label">Inventory Locations</span>
              </a>
              <a href="/settings.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M12 1v6m0 6v6m5.196-15.196l-4.243 4.243m0 5.656l-4.242 4.243m15.195-5.196l-4.242-4.243m-5.657 0l-4.243-4.243"></path>
                </svg>
                <span class="dp-nav-item__label">Settings</span>
              </a>
              <a href="/faq.html" class="dp-nav-item dp-nav-item--active">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span class="dp-nav-item__label">FAQ</span>
              </a>
              <a href="/privacy.html" class="dp-nav-item">
                <svg class="dp-nav-item__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span class="dp-nav-item__label">Support</span>
              </a>
            </div>
          </div>
        </nav>
        
        <!-- Spacer -->
        <div class="dp-sidebar__spacer"></div>
        
        <!-- User Footer -->
        <div class="dp-sidebar__footer">
          <div class="dp-user-card">
            <div class="dp-user-card__avatar" id="userAvatar">U</div>
            <div class="dp-user-card__info">
              <div class="dp-user-card__name" id="userName">Loading...</div>
              <div class="dp-user-card__status" id="userEmail">Signed in</div>
            </div>
          </div>
        </div>
      </aside>
      
      <!-- Main Content Wrapper -->
      <div class="dp-main-wrapper">
        <!-- Top Bar -->
        <header class="dp-topbar">
          <!-- Left: Page Title & Subtitle -->
          <div class="dp-topbar-left">
            <h1 class="dp-topbar__title">FAQ</h1>
            <p class="dp-topbar__subtitle">Answers to common questions about SmartDrafts and DraftPilot.</p>
          </div>
          
          <!-- Center: Search -->
          <div class="dp-topbar-center">
            <div class="dp-search">
              <svg class="dp-search__icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
              </svg>
              <input type="text" class="dp-search__input" placeholder="Search drafts, SKUs, or notes…" />
            </div>
          </div>
          
          <!-- Right: Icon Cluster -->
          <div class="dp-topbar-right">
            <button class="dp-topbar-icon" title="Theme Toggle" aria-label="Toggle theme">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
            </button>
            <button class="dp-topbar-icon" title="Notifications" aria-label="View notifications">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
              </svg>
            </button>
            <div class="dp-topbar-avatar" id="topbarAvatar" title="User menu">U</div>
          </div>
        </header>
        
        <!-- Main Content Area -->
        <main class="dp-main">
          <!-- Auth Banner -->
          <div id="authBanner" class="dp-card" style="display:none;">
            <div class="dp-card__content">
              <p style="margin-bottom: 16px;">You need to sign in to access DraftPilot.</p>
              <button id="bannerLogin" class="dp-btn dp-btn-primary">Sign in</button>
            </div>
          </div>
          
          <!-- FAQ Content -->
          <div class="dp-grid">
            <section class="dp-card">
              <div class="dp-card__header">
                <h2 class="dp-card__title">Frequently Asked Questions</h2>
                <p class="dp-card__subtitle">Everything you need to know about using DraftPilot</p>
              </div>
              
              <div class="dp-card__content">
                <div class="dp-faq-list">
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">Do I have to use Dropbox?</h3>
                    <p class="dp-faq-answer">
                      No, Dropbox is completely optional. While connecting Dropbox enables automatic import of new product photos from a chosen folder, you can also upload photos manually from your computer using the "Upload from device" option on the Create Listings page.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">What does SmartDrafts actually do?</h3>
                    <p class="dp-faq-answer">
                      SmartDrafts uses Vision AI and GPT-4 to analyze your product photos and automatically generate complete eBay listing drafts. It groups related images together, identifies the product, generates a compelling title and description, suggests pricing based on market research, and assigns the appropriate eBay category. You get ready-to-publish drafts in minutes instead of hours.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">Will anything be published automatically?</h3>
                    <p class="dp-faq-answer">
                      No, DraftPilot never publishes listings automatically. It only creates drafts that you can review, edit, and publish manually when you're ready. You have complete control over what goes live on eBay. Every draft stays in "UNPUBLISHED" status until you explicitly choose to publish it.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">Can I change how titles or descriptions are written?</h3>
                    <p class="dp-faq-answer">
                      Yes! You can edit any draft before publishing it to customize the title, description, pricing, and other details. For system-wide preferences on how DraftPilot generates content, check the Settings page where you can configure default behaviors and customize the AI's output style (additional configuration options coming soon).
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">How accurate is the AI pricing?</h3>
                    <p class="dp-faq-answer">
                      DraftPilot uses multiple pricing sources including Amazon marketplace data, brand websites, and product databases to suggest competitive prices. The AI applies smart logic to detect bundle pricing and adjust accordingly. However, all pricing suggestions should be reviewed and can be edited before publishing to ensure they match your margin requirements and market strategy.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">What eBay account settings do I need?</h3>
                    <p class="dp-faq-answer">
                      You need to connect your eBay account, opt into eBay Business Policies, and set up at least one payment policy, shipping policy, return policy, and inventory location. The setup wizard will guide you through each step when you first connect your account.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">How many photos can I upload at once?</h3>
                    <p class="dp-faq-answer">
                      You can upload as many photos as needed. SmartDrafts will automatically group related images together (front, back, and side views of the same product) and create separate draft listings for each distinct product it identifies in your photo batch.
                    </p>
                  </div>
                  
                  <div class="dp-faq-item">
                    <h3 class="dp-faq-question">Is my data secure?</h3>
                    <p class="dp-faq-answer">
                      Yes. DraftPilot uses industry-standard security practices. Your eBay and Dropbox credentials are stored using OAuth tokens (never passwords), and all API communications are encrypted. User data is scoped per account, and you can disconnect services at any time from the dashboard. See our <a href="/privacy.html">Privacy Policy</a> for full details.
                    </p>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>
    
    <script>
      async function refreshStatus() {
        let s = null;
        try {
          let headers = { };
          try {
            const t = await authClient.getToken?.();
            if (t) headers = Object.assign(headers, { Authorization: `Bearer ${t}` });
          } catch {}
          const res = await authClient.authFetch('/.netlify/functions/status', { headers });
          s = await res.json().catch(() => null);
        } catch (e) {
          console.error('[FAQ] Failed to load status:', e);
        }
        
        if (!s) return;
        
        // Update sidebar user card
        try {
          const user = s.user || {};
          const userName = document.getElementById('userName');
          const userEmail = document.getElementById('userEmail');
          const userAvatar = document.getElementById('userAvatar');
          const topbarAvatar = document.getElementById('topbarAvatar');
          
          const name = user.name || user.given_name || '';
          const email = user.email || '';
          const displayName = name || email || 'User';
          const initial = displayName.charAt(0).toUpperCase();
          
          if (userName) userName.textContent = displayName;
          if (userEmail) userEmail.textContent = email || 'Signed in';
          if (userAvatar) userAvatar.textContent = initial;
          if (topbarAvatar) topbarAvatar.textContent = initial;
        } catch {}
      }
      
      const bannerLoginBtn = document.getElementById('bannerLogin');
      if (bannerLoginBtn) bannerLoginBtn.onclick = () => {
        try { sessionStorage.setItem('returnTo', '/faq.html'); } catch {}
        location.href = '/login.html';
      };

      // Single boot: load auth/status first, then reveal main UI to avoid flashes
      async function boot() {
        try { await refreshStatus(); } catch {}
        const lc = document.getElementById('loadingCard');
        const mc = document.getElementById('mainCard');
        if (lc) lc.style.display = 'none';
        if (mc) mc.style.display = 'block';
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', boot);
      } else {
        boot();
      }
    </script>
  </body>
</html>
